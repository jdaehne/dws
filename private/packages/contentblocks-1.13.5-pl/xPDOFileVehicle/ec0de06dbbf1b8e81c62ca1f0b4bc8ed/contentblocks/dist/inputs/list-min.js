!function(d,r){r.fieldTypes.list=function(t,s){var c={itemId:0,rootList:!1,init:function(){d.isArray(s.items)?(c.rootList=t.find("ul"),d.each(s.items,function(e,t){c.addRecursiveItem(c.rootList,t)})):c.addItem(t.find(".contentblocks-field-list-outer"),{value:""}),t.find("ul, ol").sortable({items:"li",connectWith:".contentblocks-field-list-outer ul, .contentblocks-field-list-outer ol",forceHelperSize:!0,forcePlaceholderSizeType:!0,placeholder:"ui-sortable-list-placeholder",tolerance:"pointer",cursor:"move",cancel:"input,textarea,button,select,option",handle:".contentblocks-field-list-move",update:function(e,t){t.item.trigger("contentblocks:field_dragged"),r.fixColumnHeights(),r.fireChange()},start:function(e,t){t.placeholder.height(t.item.height())}})},addRecursiveItem:function(i,e){var n=this.addItem(i,{value:e.value});e.items&&e.items.length&&d.each(e.items,function(e,t){c.addRecursiveItem(i.find("#"+n).find("ul").first(),t)})},addItem:function(e,t,i,n){c.itemId++,(t=t||{value:""}).id="contentblocks-list-item"+c.itemId,n=n||0===n?n:"last";var l=tmpl("contentblocks-field-list-item",t),n=("last"===n?e.append(l):e.children("li").eq(n).after(l),e.find("#"+t.id)),o=n.find("input");return o.on("keydown",function(e){var t,i=e.which||e.keyCode,n=d(this),l=n.closest("li"),s=n.val();13==i?(e.preventDefault(),c.addItem(n.closest("ul"),{},!0,l.index())):8==i?""==s&&(e.preventDefault(),1<c.rootList.find("li").length)&&(s=jQuery.Event("keydown",{which:38}),o.trigger(s),n.closest("li").remove()):9==i?(e.preventDefault(),s=null,t=!1,e.shiftKey?(e=(s=n.closest("ul").closest("li")).closest(".contentblocks-field-list-outer"),s&&0<e.length&&(l.nextAll().appendTo(l.find("ul").first()),l.insertAfter(s),t=!0)):(n=l.prev().find("ul").first()).length&&(l.appendTo(n),t=!0),t&&((e=l.find("input")).hasClass("tinyrte-replaced")&&(e.show(),e.siblings(".tinyrte-container").hide()),e.focus())):38==i?(s=null,(n=l.prev()).length?s=(t=n.find("li").last()).length?t:n:(t=(e=l.closest("ul").closest("li")).closest(".contentblocks-field-list-outer").length,e.length&&t&&(s=e)),s&&s.find("input").first().focus()):40==i&&(n=null,t=l.find("li").first(),e=l.next(),t.length?n=t:e.length?n=e:(i=(s=l.closest("ul").closest("li").next()).closest(".contentblocks-field-list-outer").length,s.length&&i&&(n=s)),n)&&n.find("input").first().focus()}),n.find(".contentblocks-field-list-add").on("click",function(){var e=d(this).closest("li").find(".contentblocks-field-list-nested"),t=e.find("ul > li"),i=d(this);0<t.length?(t.remove(),i.text("»")):(c.addItem(e.find("ul"),{},!0),i.text("«")),r.fireChange()}),n.find(".contentblocks-field-list-delete").on("click",function(){d(this).closest("li").remove(),r.fireChange(),r.fixColumnHeights()}),i&&o.focus(),r.fixColumnHeights(),r.toBoolean(s.properties.use_tinyrte)&&r.addTinyRte(o),t.id},getData:function(){var e=t.find(".contentblocks-field-list-outer"),i=[];return e.children("li").each(function(e,t){t=d(t);i.push({value:t.find("input").first().val(),items:c.getNested(t)})}),{items:i}},getNested:function(e){var i=[];return e.find("ul").first().children("li").each(function(e,t){t=d(t);i.push({value:t.find("input").first().val(),items:c.getNested(t)})}),i}};return c},r.fieldTypes.ordered_list=function(e,t){return r.fieldTypes.list(e,t)}}(vcJquery,ContentBlocks);
//# sourceMappingURL=list-min.js.map